(import (chibi))
(define (subsets1 s) 
  (if (null? s)
    (list '())
    (let ((rest (subsets (cdr s))))
      (append rest (map (lambda (r) (if (pair? r) (list (car s) (cdr r) r) (list r))) rest))
    )
  )
)

(define (subsets s) 
  (if (null? s)
    (list '())
    (let ((rest (subsets (cdr s))))
      (append rest (map (lambda (r) (if (null? r) (list (car s)) (append (list (car s)) r))) rest))
    )
  )
)
(display (subsets (list 1 2 3)))
